<!DOCTYPE html>
<html>
<head>
  <title>Admin Panel</title>
  <script src="/socket.io/socket.io.js"></script>
  <style>
    body { font-family: Arial; background:#111; color:white; text-align:center; }
    .panel { background:#222; padding:20px; margin:15px auto; width:450px; border-radius:10px; }
    input { padding:8px; margin:5px; width:80%; }
    button { padding:8px 15px; cursor:pointer; }
  </style>
</head>
<body>

<h1>ðŸ”’ Admin Panel</h1>

<div class="panel" id="loginPanel">
  <input id="password" type="password" placeholder="Password"><br>
  <button onclick="login()">Login</button>
</div>

<div id="adminContent" style="display:none">

<div class="panel">
  <h2>Island Status</h2>
  <input id="dodoInput" placeholder="Dodo Code"><br>
  <input id="passInput" placeholder="Island Pass"><br>
  <input id="turnipInput" placeholder="Turnip Price"><br>
  <input id="timeInput" placeholder="Local Time"><br>
  <button onclick="updateIsland()">Update</button>
</div>

<div class="panel">
  <h2>Visitors</h2>
  <div id="visitorList"></div>
</div>

</div>

<script>
const socket = io();

function login(){
  fetch("/admin-login", {
    method:"POST",
    headers:{ "Content-Type":"application/json" },
    body:JSON.stringify({ password:document.getElementById("password").value })
  })
  .then(res=>res.json())
  .then(data=>{
    if(data.success){
      document.getElementById("loginPanel").style.display="none";
      document.getElementById("adminContent").style.display="block";
    } else alert("Wrong password");
  });
}

function updateIsland(){
  fetch("/update-island", {
    method:"POST",
    headers:{ "Content-Type":"application/json" },
    body:JSON.stringify({
      dodoCode: document.getElementById("dodoInput").value,
      islandPass: document.getElementById("passInput").value,
      turnipPrice: document.getElementById("turnipInput").value,
      localTime: document.getElementById("timeInput").value
    })
  });
}

socket.on("queueUpdate", data => {

  const list = document.getElementById("visitorList");
  list.innerHTML = "";

  data.users.forEach(user=>{
    const div = document.createElement("div");
    div.innerHTML =
      `#${user.position} ${user.username} (${user.island}) | IP: ${user.ip} | ` +
      (user.active ? "ACTIVE" : "Waiting");
    list.appendChild(div);
  });

});
</script>

</body>
</html>